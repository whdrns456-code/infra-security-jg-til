# 📅 TIL: 2026-02-11

## 📝 1. 오늘의 학습 주제 및 핵심 내용
- **주요 주제:** systemd 
- **핵심 개념 1:** 
- 📝 systemd 유닛 및 방화벽 관리 요약
    - 1. 유닛 설정 파일 경로
    - /usr/lib/systemd/system/: 유닛 원본 파일 (패키지 설치 시 생성).

    - /etc/systemd/system/: enable 설정 시 생성되는 심볼릭 링크(바로가기) 저장소. 관리자 설정 우선 구역.

    - /run/systemd/system/: 실행 중 일시적으로 생성되는 유닛 파일 (휘발성).

- 2. systemctl 주요 명령어
    - systemctl list-units: 활성화된 유닛 목록.

    - systemctl list-units -a: 모든 유닛(비활성 포함) 출력.

    - systemctl list-units --type mount: 마운트 유닛만 필터링.

    - systemctl list-unit-files: 부팅 시 자동 실행 여부(state) 확인.

    - systemctl list-unit-files -t service: 서비스 유닛만 확인.

- 3. 유닛 상태(State) 판독
    - enabled: 부팅 시 자동 실행됨.
    - disabled: 부팅 시 자동 실행 안 됨.
    - static: 다른 유닛의 의존성에 의해 필요할 때만 실행됨.
    - masked: 강제 비활성화(프리징). unmask 전까지는 절대 실행 불가.

- 4. 방화벽 관리 (firewalld vs iptables)
    - 충돌 주의: 두 프로세스를 동시에 켜면 방화벽 먹통 됨.
    - iptables: 설정 변경 후 서비스 재시작 필수 (실시간 반영 불가).
    - firewalld: 실시간 설정 반영 가능, systemd 환경에 최적화.
    - 권장 사항: 하나를 쓸 때 나머지는 mask 처리해서 충돌 방지.

- 5. 자원 및 종속성 관리
    - cgroup: CPU, 메모리 등 시스템 자원을 유닛별로 할당하고 관리하는 핵심 기술.

- **핵심 개념 2: log**

# 리눅스 시스템 로그 관리 핵심 정리

## 1. 로그(Log)의 정의와 중요성
* **정의**: 시스템에서 발생하는 모든 이벤트와 상태 변화의 기록입니다.
* **중요성**: 장애 발생 시 원인을 파악하기 위한 첫 번째 수단이며, 보안 및 시스템 상태를 모니터링하는 근거 자료가 됩니다.

---

## 2. 로그 관리 아키텍처
리눅스는 효율적인 로그 관리를 위해 수집과 저장을 분리하여 운영합니다.

### systemd-journald (수집기)
* **역할**: 커널 및 서비스의 로그를 실시간으로 수집합니다.
* **저장**: `/run/log/journal/` (휘발성 메모리 방식, 재부팅 시 초기화)
* **특징**: 바이너리 데이터 형식 (전용 명령어 `journalctl`로 조회)

### rsyslogd (저장소)
* **역할**: 저널 로그를 전달받아 규칙에 따라 텍스트 파일로 분류하고 디스크에 저장합니다.
* **저장**: `/var/log/` (영구 디스크 방식, 재부팅 후에도 유지)



---

## 3. 주요 로그 파일 경로
`/var/log/` 하위의 주요 파일들은 목적에 따라 분류됩니다.

| 경로 | 내용 |
| :--- | :--- |
| `/var/log/messages` | 시스템 일반 로그 (인증, 메일, 반복예약, 부팅, 디버그 제외) |
| `/var/log/secure` | 인증(Login, SSH, sudo 등) 관련 로그 |
| `/var/log/maillog` | 메일 서비스 관련 로그 |
| `/var/log/cron` | 반복 예약 작업(cron, at) 관련 로그 |
| `/var/log/boot.log` | 부팅 과정 및 서비스 시작/종료 기록 |

---

## 4. 로그 설정 체계 (Facility & Priority)
`/etc/rsyslog.conf` 설정 시 `기능(Facility).우선순위(Priority)` 형식을 사용합니다.

### Facility (로그의 종류)
* **authpriv**: 개인 인증 관련 (보안 파일 저장)
* **cron**: 스케줄링(cron) 관련
* **daemon**: 각종 데몬 서비스 관련
* **kern**: 커널 발생 메시지
* **mail**: 메일 서비스

### Priority (로그 우선순위)
우선순위 숫자가 작을수록 치명적인 상태를 의미합니다.

| 번호 | 등급 | 설명 | 표기(journalctl) |
| :--- | :--- | :--- | :--- |
| 0 | **emerg** | 시스템 가용 불가 (최악) | 빨간색 |
| 1 | **alert** | 즉각 조치 필요 | 빨간색 |
| 2 | **crit** | 위험 상태 | 빨간색 |
| 3 | **err** | 일반 에러 | 빨간색 |
| 4 | **warning** | 주의/경고 | 볼드체 |
| 5 | **notice** | 주의 깊은 관찰 필요 | 볼드체 |
| 6 | **info** | 일반 정보 메시지 | 일반 텍스트 |
| 7 | **debug** | 디버깅용 상세 메시지 | 일반 텍스트 |
---

## 5. 핵심 관리 명령어

### Rsyslog 관리
* **설정 반영**: 파일 수정 후 반드시 실행
- systemctl restart rsyslog.service
- tail -f /var/log/파일명

# 형식: logger -p 기능.우선순위 "메시지"
- logger -p cron.crit "Cron Critical Error Test"

- Journalctl 조회
    - journalctl -n 5: 최근 5개 로그 출력

- journalctl -p err: 에러(3) 등급 이상만 출력

- journalctl -f: 실시간 로그 모니터링

- journalctl --since "2026-02-02" --until "2026-02-03": 기간별 조회

---

## 💻 2. 실습 및 구현 내용
### ✅ 실습 목표
- 

### 🛠️ 구현 결과
```language
// 코드를 입력하세요
```

### ✨ 새롭게 알게 된 점
- 

---

## 🛠️ 3. 트러블슈팅 (Troubleshooting)
### 🔍 문제 발생 (Issue)
- **상황:** 
- **에러 메시지:** `ls: cannot access '/var/log/cron1': 그런 파일이나 디렉터리가 없습니다`

- 1. rsyslog: 설정 적용 후 파일이 생성되지 않는 경우
- 2. SELinux의 보안 차단
- 3. vi 편집기 비정상 종료 (백그라운드 멈춤)


### 💡 원인 분석 (Cause)
- 
증상: /etc/rsyslog.conf를 수정하고 logger를 쐈으나, 지정한 로그 파일이 생성되지 않거나 로그가 기록되지 않음.
- 체크리스트 및 해결법
- 서비스 재시작 누락 (가장 빈번)
- 원인: 설정 파일은 정적 텍스트일 뿐입니다. 프로세스가 이를 다시 읽게 해야 한다.
- 2.SELinux의 보안 차단
- 3.vi 편집기 비정상 종료 (백그라운드 멈춤)
    - 원인: Ctrl+Z로 종료하면 .swp 파일이 남고 설정이 파일에 반영되지 않을 수 있다.
### 🚀 해결 방법 (Solution)
- 조치: systemctl restart rsyslog
- 조치: setenforce 0 (임시 해제)으로 테스트 후, 필요시 chcon 또는 semanage로 보안 문맥을 수정.
- 수행 코드 setenforce 0
- 조치: jobs로 확인 후 kill %번호로 정리, 반드시 :wq로 저장 종료.
---

## 🧐 4. 오늘의 회고
### 💡 성찰 및 성장
- **습득 지식: systemd** 
- **협업/소통:** 

### 🚀 Action Plan
- **부족한 점:** 
- **개선 방안:** 
- **내일의 목표:** 

---

## 📊 5. 메타인지 측정
### 🎯 오늘의 학습 점수
- **자기 객관화 점수:** ⭐ 7/10
- **이유: 어제는 왜 쓰는지가 명확히 몰라서 수업 집중도가 매우 낮았다 오늘은 그래도 익숙한 단어들을 들으면서 수강을 하니까 괜찮았다** 

---

### 🤝 공유 및 토론
- **참고 자료:** 
- **궁금한 점:** 