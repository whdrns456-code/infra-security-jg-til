# 📅 TIL: 2026-02-18

## 📝 1. 오늘의 학습 주제 및 핵심 내용
- **주요 주제: 도커로 배포하기**

- **핵심 개념 1: application.yml의 URL 설정** 
`spring:`
  `datasource:`
    `# localhost 대신 도커 서비스명인 'oracle-db'를 넣습니다.`
    `url: jdbc:oracle:thin:@${DB_HOST:oracle-db}:1521:xe`
    `username: ${DB_USERNAME}`
    `password: ${DB_USERPASSWORD}`

    - 중요 데이터 기밀성을 유지할 수 있는 장점이 있다. 직접적으로 레포지터리에 데이터를 삽입을 하는게 아닌 환경변수로 이용하여 중요 정보 노출을 최소화 시킨다. 
    - 컨테이너 간 통신: DB와 스프링이 컨테이너 단위로 구성이 되어 스프링에 오류로 부터 
    - DB는 안전하게 된다. 컨테이너화가 도커 핵심 개념 중 하나이지 않을까 생각이 든다. 

- `docker-compose up --build -d`
    - Dockerfile을 읽어 새롭게 이미지를 만든다. (방금 빌드한 JAR를 반영하기 위함)
    - docker ps 컨테이너가 잘 생성이 되었는지 확인을 한다. 
    - STATUS가 Up으로 되어 있어야 한다. 
    - 만약 Exited라면 에러가 난 것. 
    - docker logs -f spring-app 
- `.env 파일`
    - 내가 환경 변수로 등록해둔 값들이 저장된 파일이다. 
    - 도커 배포 시 해당 파일을 읽어 환경변수를 따로 저장하지 않아도 사용할 수 있게한다. 
    - 인코딩 문제가 발생할 수 있다 가급적.. 메모장에서 .env 파일을 만들고 
    - 저장해서 사용하기를 바란다. 
- `docker logs -f spring-app`
    - 스프링 부트가 올라가는 과정이다. 
- `docker logs -f my-secure-oracle`
    - 로그 마지막에 DATABASE IS READY TO USE!라는 문구가 뜬다면 성공이다. 


- **핵심 개념 2:** 
- **핵심 개념 3:** 

---

## 💻 2. 실습 및 구현 내용
### ✅ 실습 목표
- 

### 🛠️ 구현 결과
```language
// 코드를 입력하세요
```

### ✨ 새롭게 알게 된 점
- 

---

## 🛠️ 3. 트러블슈팅 (Troubleshooting)
### 🔍 문제 발생 (Issue)
- **상황:** 
- **에러 메시지:** `failed to solve: openjdk:17-jdk-slim: failed to resolve source metadata for docker.io/library/openjdk:17-jdk-slim: docker.io/library/openjdk:17-jdk-slim: not found`

### 💡 원인 분석 (Cause)
- `이미지 창고(Registry)`
    - 커널 크기가 큰 것인지 
    - OpenJDK 공식 이미지가 Docker Hub에서 'Deprecated(지원 중단)을 한건지 알 수 없었다.
- `application.yml` 
    - 수정 전 : xe 표준 주소 사용 
    - 수정 후 : xepdb1

- # 1. 앱 재시작
    - docker-compose restart app

- # 2. 앱 로그 확인 
    - docker logs -f spring-app

- docker-compose down -v
- docker-compose up -d --build



### 🚀 해결 방법 (Solution)
- # 기존 openjdk 대신, 안정적인 eclipse-temurin을 사용.
`FROM eclipse-temurin:17-jdk-focal`

- # 2. JAR 파일을 컨테이너 내부로 복사
`COPY care-system-0.0.1-SNAPSHOT.jar app.jar`

# 3. 앱 실행
`ENTRYPOINT ["java", "-jar", "/app.jar"]`

- temurin은 slim보다 가볍고 호환성도 좋아서 가장 많이 사용한다고 한다

# 실시간 말고, 지금까지 쌓인 로그 전체 보기
docker logs spring-app


---

## 🧐 4. 오늘의 회고
### 💡 성찰 및 성장
- **습득 지식:** 
- **협업/소통:** 

### 🚀 Action Plan
- **부족한 점:**
    - 최소 권한으로 공격 표현을 줄이기 위해서 

    - 1. 사용자 생성 (비밀번호 1234)
    - `CREATE USER whdrns IDENTIFIED BY ;`

    - 2. 접속 및 리소스 사용 권한 부여
    - `GRANT CONNECT, RESOURCE, DBA TO whdrns;`

    - 3. 저장
    - `COMMIT;`

    - 4. 나가기
    - `EXIT;`

- # 앱 컨테이너만 다시 시작
    - `docker-compose restart app`

- # 로그 확인 (이번엔 정말 기분 좋은 로그가 뜰 겁니다!)
    - `docker logs -f spring-app`
- 나는 Dockerfile에다가 
- 넣은 최소 권한 계정으로 해당 프로그램을 실행을 하고 싶었다 
- 나중에 해킹을 당하더라도 권한 축소 (Least Privilege)를 통해서 피해를 최소화 시킬 수 있을거라고 생각을 했는데 
- 일단 계정으로는 db가 정상적으로 실행이 되지 않는다. 
- 어쩔 수 없이 system 권한으로 프로그램을 실행하게 되었다. 
- 최소 권한의 원칙 (Principle of Least Privilege)
    - 


- **개선 방안:** 
- **내일의 목표:** 

---

## 📊 5. 메타인지 측정
### 🎯 오늘의 학습 점수
- **자기 객관화 점수:** ⭐ 0/10
- **이유:** 

---

### 🤝 공유 및 토론
- **참고 자료:** 
- **궁금한 점:** 